<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1, minimum-scale=1">
  <title>å°ç çŸ­é“¾æ¥</title>

  <!-- å…¬å…±ï¼šè·å–urlçš„å‚æ•° -->
  <script>
    // eslint-disable-next-line no-unused-vars
    function getUrlQuery() {
      var search = window.location.search.slice(1).split('&')
      var query_map = {}
      var param_arr

      search.forEach(function(param) {
        if (param && param.indexOf('=') !== -1) {
          param_arr = param.split('=')
          query_map[param_arr[0]] = query_map[param_arr[0].toLocaleLowerCase()] = decodeURIComponent(param_arr[1] || '')
        }
      })

      console.log({
        query_map
      })
      return query_map
    }
  </script>

  <!-- å…¬å…±ï¼šè®¡ç®—é¡µé¢ html çš„ font-size -->
  <script>
    /* å¤‡æ³¨ï¼šè®¾ç½®htmlçš„font-sizeï¼Œç”¨äºremçš„è®¡ç®—ï¼ŒæŒ‰ç…§375çš„è®¾è®¡ç¨¿ */
    var w_document = document.documentElement.clientWidth

    // å¤‡æ³¨ï¼šä¹˜ä»¥10çš„åŸå› æ˜¯å®‰å“æœºä¸Šï¼Œå¾®ä¿¡å†…åµŒæµè§ˆå™¨çš„æœ€å°å­—ä½“å¤§å°å¥½åƒä¸æ”¯æŒ1pxï¼ˆå…·ä½“ä»€ä¹ˆåŸå› ä¸çŸ¥é“ï¼‰
    // eslint-disable-next-line prettier/prettier
    var value_font_size = w_document / 375 * 10

    // ä¸è®©å­—ä½“å¤ªå°
    if (value_font_size < 10) {
      value_font_size = 10
    }
    if (value_font_size > 20) {
      value_font_size = 20
    }
    document.documentElement.style.fontSize = value_font_size + 'px'
  </script>

  <!-- å…¬å…±ï¼šXMLHttpRequest çš„ GET å’Œ POST çš„å°è£… -->
  <script type="text/javascript">
    /* eslint-disable vars-on-top */
    // eslint-disable-next-line no-unused-vars
    function request(option) {
      if (String(option) !== '[object Object]') {
        return false
      }

      option.method = option.method ? option.method.toUpperCase() : 'GET'
      option.data = option.data || {}

      // GET çš„å‚æ•°
      var formData = []

      for (var key in option.data) {
        formData.push(''.concat(key, '=', encodeURIComponent(option.data[key])))
      }
      option.data = formData.join('&')

      if (option.method === 'GET') {
        option.url += location.search.length === 0 ? ''.concat(option.data ? '?' : '', option.data) : ''.concat('&', option.data)
      }

      // æ–°å»ºä¸€ä¸ªè¯·æ±‚
      var xhr = new XMLHttpRequest()

      xhr.responseType = option.responseType || 'json'

      xhr.onreadystatechange = function() {
        if (xhr.readyState === 4) {
          if (xhr.status === 200) {
            if (option.success && typeof option.success === 'function') {
              typeof option.success === 'function' && option.success(xhr.response)
            }
          } else if (option.error && typeof option.error === 'function') {
            typeof option.error === 'function' && option.error()
          }
        }
      }

      xhr.open(option.method, option.url, true)

      if (option.method === 'POST') {
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded')
      }

      xhr.send(option.method === 'POST' ? option.data : null)
    }
  </script>

  <!-- å…¬å…±ï¼šåˆ¤æ–­ç”¨æˆ·è®¾å¤‡ -->
  <script>
    // eslint-disable-next-line no-unused-vars
    function getDeviceInfo() {
      var userAgent = window.navigator.userAgent.toLowerCase()
      var is_android = /(android)/.test(userAgent)
      var is_iphone = /(iphone|ipod|ios)/.test(userAgent) // æ·˜å®ipadæ— æ³•ç›´æ¥æ‰“å¼€
      var is_mobile = is_android || is_iphone
      var is_weixin_browser = /micromessenger/.test(userAgent)

      return {
        is_mobile,
        is_android,
        is_iphone,
        is_weixin_browser
      }
    }
  </script>

  <!-- ä¸šåŠ¡ï¼šæµ‹è¯•æ•°æ® -->
  <script>
    /*
        å­—æ®µå«ä¹‰
          remark            å¤‡æ³¨
          short_url         æ·˜å®åˆ†äº«å‡ºæ¥çš„çŸ­é“¾æ¥ï¼ˆè¿™é‡Œéœ€è¦çš„åŸå› æ˜¯ï¼Œæ·˜å®ä¼šè‡ªåŠ¨åˆ¤æ–­é…å¤‡é‡å®šå‘ï¼‰
          scheme_url        å¯¹åº”çš„åè®®ï¼Œéœ€è¦lyå»è·å–å¯¹åº”çš„å‚æ•°
     */
    // eslint-disable-next-line no-unused-vars
    var test_data = {
      item: {
        remark: 'æ·˜å®å•†å“',
        short_url: 'https://m.tb.cn/h.VTCHwfH?sm=a25ac4',
        scheme_url: 'taobao://item.taobao.com/item.htm?id=596435689854'
        // æ‰‹æœºç«¯å®é™…è·³è½¬ï¼Œç»™lyä½œä¸ºschemeåè®®å‚æ•°è·å–çš„å‚è€ƒï¼š
        // 'https://h5.m.taobao.com/awp/core/detail.htm?ut_sk=1.WnhdnnBc2ecDABRfZBuEDneU_21380790_1586254475671.Copy.1&id=596435689854&sourceType=item&price=33-88&suid=4A44C2AD-B096-4C1F-8E68-399C9B6D08B8&un=b30652abac3f4e2c621065bb730f8a84&share_crt_v=1&spm=a2159r.13376460.0.0&sp_tk=4oK0OUpJeDFRUVNBSjLigrQ=&cpp=1&shareurl=true&short_name=h.VTCHwfH&sm=a25ac4&app=chrome'
      },
      item2: {
        remark: 'å¤©çŒ«å•†å“',
        short_url: 'https://m.tb.cn/h.V61FBKz?sm=613508',
        scheme_url: 'taobao://item.taobao.com/item.htm?id=599818729301'
        // æ‰‹æœºç«¯å®é™…è·³è½¬ï¼Œç»™lyä½œä¸ºschemeåè®®å‚æ•°è·å–çš„å‚è€ƒï¼š
        // 'https://detail.m.tmall.com/item.htm?id=599818729301&ut_sk=1.WnhdnnBc2ecDABRfZBuEDneU_21380790_1586317656812.Copy.1&sourceType=item&price=99&origin_price=198&suid=E0DFDF7D-0CC1-4F81-979C-C0E6D8115BBF&un=b30652abac3f4e2c621065bb730f8a84&share_crt_v=1&spm=a2159r.13376460.0.0&sp_tk=4oKzZjlGbTFRcGNFNHLigrM=&cpp=1&shareurl=true&short_name=h.V61FBKz&sm=613508&app=chrome'
      },
      shop: {
        remark: 'æ·˜å®åº—é“º',
        short_url: 'https://m.tb.cn/h.VhWX9DK?sm=bc5d9d',
        scheme_url: 'taobao://shop503140184.m.taobao.com'
        // æ‰‹æœºç«¯å®é™…è·³è½¬ï¼Œç»™lyä½œä¸ºschemeåè®®å‚æ•°è·å–çš„å‚è€ƒï¼š
        // 'https://shop503140184.m.taobao.com/?ut_sk=1.WnhdnnBc2ecDABRfZBuEDneU_21380790_1586329128840.Copy.shop&weexShopSubTab=shopindex&sourceType=shop&weexShopTab=shopindexbar&suid=4DA8AAB8-7F3F-4BAE-B455-4EFAE1D42610&un=b30652abac3f4e2c621065bb730f8a84&share_crt_v=1&spm=a2159r.13376460.0.0&sp_tk=77+lN2ZuNjFRSmtoVGXvv6U=&cpp=1&shareurl=true&short_name=h.VhWX9DK&app=chrome'
      },
      shop2: {
        remark: 'å¤©çŒ«åº—é“º',
        short_url: 'https://m.tb.cn/h.Vh3f2o4?sm=7b8d65',
        scheme_url: 'taobao://xianyouhuiju.m.tmall.com'
        // æ‰‹æœºç«¯å®é™…è·³è½¬ï¼Œç»™lyä½œä¸ºschemeåè®®å‚æ•°è·å–çš„å‚è€ƒï¼š
        // 'https://xianyouhuiju.m.tmall.com/?ut_sk=1.WnhdnnBc2ecDABRfZBuEDneU_21380790_1586333490933.Copy.shop&weexShopSubTab=shopindex&sourceType=shop&weexShopTab=shopindexbar&suid=B5F26CDC-89D4-4F3B-B433-48654F4BBD44&un=b30652abac3f4e2c621065bb730f8a84&share_crt_v=1&spm=a2159r.13376460.0.0&sp_tk=77+lUWNxZTFRcnV4ak3vv6U%3D&cpp=1&shareurl=true&short_name=h.Vh3f2o4&sm=7b8d65&app=chrome'
      }
    }
  </script>

  <!-- ä¸šåŠ¡ï¼šè·å–æ·˜å®çŸ­é“¾å¯¹åº”çš„ç›®æ ‡é“¾æ¥ -->
  <script>
    // eslint-disable-next-line no-unused-vars
    function getUrlInfo() {
      // eslint-disable-next-line no-undef
      const query_map = getUrlQuery()
      const type = query_map.type || 'item'

      // eslint-disable-next-line no-undef
      var res = test_data[type] || {}
    
      res.ios_url = 'https://t.asczwa.com/taobao?backurl=' + res.short_url

      return res
    }
  </script>

  <!-- ä¸šåŠ¡ï¼šæ˜¯å¦æ˜¯å¾®ä¿¡æµè§ˆå™¨çš„å¤„ç† -->
  <script>
    // eslint-disable-next-line no-undef
    var device_info = getDeviceInfo()
    // eslint-disable-next-line no-undef
    var url_info = getUrlInfo()

    window.addEventListener('load', function() {
      var block__top = document.getElementById('block__top')
      var block__bottom = document.getElementById('block__bottom')
      var div__test = document.getElementById('div__test')
      var test_center = document.getElementById('test_center')
      var rem = document.documentElement.style.fontSize

      rem = rem.split('px')[0] || 10
    
      // æµ‹è¯•æ•°æ®
      function getHTML() {
        // eslint-disable-next-line no-undef
        var arr = Object.keys(test_data)
        var res = document.createElement('div')

        var remark = document.createElement('div')

        remark.innerHTML = 'ç‚¹å‡»åï¼Œå†æ‰“å¼€'
        res.appendChild(remark)

        arr.forEach(function(item) {
          var temp = document.createElement('div')

          temp.className = 'btn btn-margin'
          // eslint-disable-next-line no-undef
          temp.innerHTML = test_data[item].remark
          temp.addEventListener('click', function() {
            window.location.replace(window.location.origin + window.location.pathname + '?type=' + item)
          })
          res.appendChild(temp)
        })
        return res
      }

      if (device_info.is_mobile) {
        if (device_info.is_weixin_browser) {
          // åœ¨ç§»åŠ¨ç«¯.å¾®ä¿¡æµè§ˆå™¨ä¸­æ‰“å¼€
          block__top.style.paddingRight = (device_info.is_iphone ? 31.5 : 28.5) - rem + 'px' // é€‚é…ä¸‰ä¸ªç‚¹ç‚¹çš„ä½ç½®
          block__top.style.display = 'flex'
          block__bottom.style.display = 'flex'

          test_center.appendChild(getHTML())
          test_center.style.display = 'flex'
        } else {
          // åœ¨ç§»åŠ¨ç«¯.éå¾®ä¿¡æµè§ˆå™¨ä¸­æ‰“å¼€
          window.location.href = device_info.is_android ? url_info.scheme_url : url_info.ios_url
          div__test.textContent = 'ç§»åŠ¨ç«¯å‡†å¤‡è·³è½¬ï¼š' + (device_info.is_android ? url_info.scheme_url : url_info.ios_url)
          // æ‰“å¼€ç›®æ ‡é¡µï¼ˆå¤‡æ³¨ï¼šå½“ç”¨æˆ·æ²¡æœ‰appï¼Œåˆ™ç›´æ¥æ˜¾ç¤ºh5é¡µé¢ï¼‰
          setTimeout(function() {
            window.location.href = url_info.short_url
          }, 300)
        }
      } else {
        // åœ¨pcç«¯æ‰“å¼€
        window.location.href = url_info.short_url || url_info.ios_url
        div__test.textContent = 'pcå‡†å¤‡è·³è½¬ï¼š' + (url_info.short_url || url_info.ios_url)
      }
    })
  </script>

  <!-- ä¸šåŠ¡ï¼šæ¥å£è¯·æ±‚ -->
  <script>
    // æµ‹è¯•æ¥å£çš„è¯·æ±‚
    // eslint-disable-next-line no-undef
    // request({
    //   url: 'https://xiaomark.com/api/slmp/links/aseh7loi/',
    //   method: 'GET',
    //   data: {},
    //   success: function(res) {
    //     console.log({
    //       res
    //     })
    //   },
    //   error: function(err) {
    //     console.log({
    //       err
    //     })
    //   }
    // })
  </script>

  <!-- é¡µé¢æ ·å¼ -->
  <style>
    html,
    body {
      padding: 0;
      margin: 0;
    }

    /* html {
      font-size: 4%;
    } */
    #container {
      width: 100vw;
      height: 100vh;
      font-size: calc(14rem/10);
      line-height: calc(20rem/10);
      position: relative;
      background: pink;
      overflow: hidden;
    }

    #block__top {
      width: 100vw;
      position: absolute;
      top: 0;
      right: 0;
      display: none;
      flex-direction: column;
      align-items: flex-end;
      background: lightblue;
      padding-top: calc(4rem/10);
      /* padding-right: calc(31.5px - 10rem/10); */
    }

    #block__bottom {
      width: 100vw;
      position: absolute;
      bottom: 0;
      right: 0;
      display: none;
      align-items: center;
      justify-content: center;
      background: lightblue;
      padding-bottom: calc(80rem/10);
    }

    #test_center {
      display: flex;
      align-items: center;
      justify-content: center;
      position: absolute;
      z-index: 99;
      top: calc(100rem/10);
      bottom: calc(110rem/10);
      /* height: calc(300rem/10); */
      width: 100vw;
      background: rgba(0, 0, 0, 0.2);
      overflow-y: auto;
    }

    #img--arrow {
      display: block;
      width: calc(20rem/10);
      height: calc(20rem/10);
      margin-bottom: calc(4rem/10);
    }

    #block__btns {
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 80%;
    }

    .btn {
      width: calc(120rem/10);
      height: calc(40rem/10);
      font-size: calc(14rem/10);
      border-radius: calc(4rem/10);
      border: 1px solid #a8a8a8;
      align-items: center;
      justify-content: center;
      display: flex;
      background: lightgoldenrodyellow;
    }

    .btn-margin {
      margin-bottom: calc(12rem/10);
      margin-top: calc(12rem/10);
    }
  </style>
</head>

<body>
  <div id="container">
    <div id="div__test"></div>
    <!-- å¾®ä¿¡å†…æ‰“å¼€ -->
    <div id="block__top">
      <img id="img--arrow"
        src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACIUlEQVRYR+2VMUwTURjHv68p0sLGRJTEVVlkgqFtil4lpl0lEBJWlh4JBB3A2S5KNKG3sJIYCK4Qg5zScB1kggVYScA4sUGLNv3IUQ8uvXv37n0dWNqt7Xf3+73/vfc/hHv+4D3zoS3ATiD1cjpN9fqK/QgxEpnc/b5U4jxOlkAyow8T0QYQdN1AES4RMWdtF3dUJZQFPHCHyJRQEhDCW5AILeALRyjcsAkWbqNXTCKUgAheNo13Njih5d9zJaQCMrizcq5EoEBYeCsSQgFVOFfCV4AL50h4BNLadKoG9W+3JdMomoKz4RzI6Ohs/Pf53xn7+8OeB5/X1z9V3CWU0vRCnWjefTqiEHlVMpd23XMegaSWPySCp64LPfCRkTfdl7XqBgGlG35Y6orGcltbHy+CJBDhyDKNfomA/ouIBv9XrBR+10H+Eu7TgYh7llkcChR4kZ17fHVVzSPivrVd/OIebl55c++Lkkhm9AkiGujsjBk/NhdPAgVELxN/OB435umJLAnRfaVFZF8ognfE4s/t//9VKz+5ElKBIPjO5oc/tsBw9m0vVyJQIAzciZYrIRRQgbci4SvAgXMlPAKtwDkSHoGEpq8C0djdscFje7c7G050nJp/99sTgLhWNovjgT2Q0PKnQPCoMcSDC5NAOCubRp/sXTAFBIsAeBCNxV+rrtwviVq18hWAngHCnGUay6wmDBu96py0iFRvqDrfFrgG79ChMILMl3sAAAAASUVORK5CYII="
        alt="å‘ä¸Šçš„ç®­å¤´" />
      <div>ç‚¹å‡»å³ä¸Šè§’</div>
      <div>é€‰æ‹©åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€</div>
      <div>ğŸ˜Šè‡ªåŠ¨æ‰“å¼€æ·˜å®</div>
    </div>
    <div id="block__bottom">
      <div>åœ¨ Safari ä¸­æ‰“å¼€</div>
    </div>
    <div id="test_center">
    </div>
  </div>
</body>

</html>