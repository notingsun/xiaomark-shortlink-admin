<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1, minimum-scale=1">
  <title>å°ç çŸ­é“¾æ¥-è‡ªåŠ¨æ‰“å¼€æŠ–éŸ³</title>

  <!-- å…¬å…±å‡½æ•° -->
  <script src="./common.js"></script>

  <!-- ä¸šåŠ¡ï¼šæµ‹è¯•æ•°æ® -->
  <script>
    /*
        å­—æ®µå«ä¹‰
          remark            å¤‡æ³¨
          short_url         æŠ–éŸ³åˆ†äº«å‡ºæ¥çš„çŸ­é“¾æ¥ï¼ˆå¤‡æ³¨ï¼šiosä¸­ä¼šé‡å®šå‘ä¸ºé€šç”¨é“¾æ¥universal_linkï¼Œæ‰€ä»¥universal_linkå°±ä¹Ÿç›´æ¥ç”¨çŸ­é“¾æ¥ï¼Œä¸ç„¶å¤ªé•¿äº†ï¼‰
          universal_link    æŠ–éŸ³appå¯¹åº”çš„é€šç”¨é“¾æ¥ï¼ˆæ³¨æ„ï¼šæŠ–éŸ³APPæ²¡æœ‰ç›´æ’­ã€å’Œç‰¹æ•ˆçš„é€šç”¨é“¾æ¥ï¼Œæ‰€ä»¥å€¼ä¸ºç©ºï¼‰
          scheme_url        å¯¹åº”çš„schemeåè®®åœ°å€ï¼Œéœ€è¦lyå»è·å–å¯¹åº”çš„å‚æ•°
     */
    // eslint-disable-next-line no-unused-vars
    var test_data = {
      live: {
        remark: 'ç›´æ’­',
        short_url: 'https://v.douyin.com/cyjNPg/',
        universal_link: '',
        scheme_url: 'snssdk1128://live?room_id=6812904627495766797&user_id=3491662970758743&from=webview&refer=web'
        // æ‰‹æœºç«¯å®é™…è·³è½¬ï¼Œç»™lyä½œä¸ºschemeåè®®å‚æ•°è·å–çš„å‚è€ƒï¼š(è¿™ä¸ªåœ°å€å®é™…ä¸Šå°±æ˜¯universal_link)
        // 'https://www.iesdouyin.com/share/live/6812904627495766797?u_code=13mdb8ick&anchor_id=3491662970758743&utm_campaign=client_share&app=aweme&utm_medium=ios&tt_from=copy&utm_source=copy'
      },
      video: {
        remark: 'è§†é¢‘é“¾æ¥',
        short_url: 'https://v.douyin.com/cyUhhP/',
        universal_link: 'https://v.douyin.com/cyUhhP/'
        // æ‰‹æœºç«¯å®é™…è·³è½¬ï¼Œç»™lyä½œä¸ºschemeåè®®å‚æ•°è·å–çš„å‚è€ƒï¼š(è¿™ä¸ªåœ°å€å®é™…ä¸Šå°±æ˜¯universal_link)
        // https://www.iesdouyin.com/share/video/6770511227228540168/?region=CN&mid=6770451162412911373&u_code=13mdb8ick&titleType=title&timestamp=1585888768&utm_campaign=client_share&app=aweme&utm_medium=ios&tt_from=copy&utm_source=copy'
      },
      user: {
        remark: 'ä¸ªäººä¸»é¡µ',
        short_url: 'https://v.douyin.com/cyQ3MA/',
        universal_link: 'https://v.douyin.com/cyQ3MA/',
        scheme_url: 'snssdk1128://user/profile/91869109044'
        // æ‰‹æœºç«¯å®é™…è·³è½¬ï¼Œç»™lyä½œä¸ºschemeåè®®å‚æ•°è·å–çš„å‚è€ƒï¼š(è¿™ä¸ªåœ°å€å®é™…ä¸Šå°±æ˜¯universal_link)
        // https://www.iesdouyin.com/share/user/91869109044?u_code=13mdb8ick&sec_uid=MS4wLjABAAAA_Fzez5ORDHYv1XAQ56lYM4BYBdNzWEOWxAvo5qSSQ5A&utm_campaign=client_share&app=aweme&utm_medium=ios&tt_from=copy&utm_source=copy'
      },
      sticker: {
        remark: 'ç‰¹æ•ˆé¡µ',
        short_url: 'https://v.douyin.com/cyhj2A/',
        universal_link: '',
        scheme_url: 'snssdk1128://stickers/detail/532821'
        // æ‰‹æœºç«¯å®é™…è·³è½¬ï¼Œç»™lyä½œä¸ºschemeåè®®å‚æ•°è·å–çš„å‚è€ƒï¼š(è¿™ä¸ªåœ°å€å®é™…ä¸Šå°±æ˜¯universal_link)
        // https://www.iesdouyin.com/share/sticker/detail/532821/?schema_type=17&object_id=532821&utm_campaign=client_share&app=aweme&utm_medium=ios&tt_from=copy&utm_source=copy'
      },
      challenge: {
        remark: 'è¯é¢˜',
        short_url: 'https://v.douyin.com/cyxXV7/',
        universal_link: 'https://v.douyin.com/cyxXV7/',
        scheme_url: 'snssdk1128://challenge/detail/1642037698569228'
        // æ‰‹æœºç«¯å®é™…è·³è½¬ï¼Œç»™lyä½œä¸ºschemeåè®®å‚æ•°è·å–çš„å‚è€ƒï¼š(è¿™ä¸ªåœ°å€å®é™…ä¸Šå°±æ˜¯universal_link)
        // https://www.iesdouyin.com/share/challenge/1642037698569228/?u_code=14h9923ec&utm_campaign=client_share&app=aweme&utm_medium=ios&tt_from=copy&utm_source=copy
      },
      music: {
        remark: 'éŸ³ä¹',
        short_url: 'https://v.douyin.com/cyju8K/',
        universal_link: 'https://v.douyin.com/cyju8K/',
        scheme_url: 'snssdk1128://music/detail/6763092917251754760'
        // æ‰‹æœºç«¯å®é™…è·³è½¬ï¼Œç»™lyä½œä¸ºschemeåè®®å‚æ•°è·å–çš„å‚è€ƒï¼š(è¿™ä¸ªåœ°å€å®é™…ä¸Šå°±æ˜¯universal_link)
        // https://www.iesdouyin.com/share/music/6763092917251754760?utm_campaign=client_share&app=aweme&utm_medium=ios&tt_from=copy&utm_source=copy
      }
    }
  </script>

  <!-- ä¸šåŠ¡ï¼šè·å–æŠ–éŸ³çŸ­é“¾å¯¹åº”çš„ç›®æ ‡é“¾æ¥ -->
  <script>
    // eslint-disable-next-line no-unused-vars
    function getUrlInfo(url) {
      // eslint-disable-next-line no-undef
      const query_map = getUrlQuery()
      const type = query_map.type || 'video'

      // eslint-disable-next-line no-undef
      return test_data[type]
    }
  </script>

  <!-- ä¸šåŠ¡ï¼šæ˜¯å¦æ˜¯å¾®ä¿¡æµè§ˆå™¨çš„å¤„ç† -->
  <script>
    // eslint-disable-next-line no-undef
    var device_info = getDeviceInfo()
    // eslint-disable-next-line no-undef
    var url_info = getUrlInfo('https://v.douyin.com/vqW629/')

    console.log(device_info)
    console.log(url_info)

    window.addEventListener('load', function() {
      var block__top = document.getElementById('block__top')
      var block__bottom = document.getElementById('block__bottom')
      var div__test = document.getElementById('div__test')
      var test_center = document.getElementById('test_center')
      var rem = document.documentElement.style.fontSize

      rem = rem.split('px')[0] || 10
    
      function getHTML() {
        // eslint-disable-next-line no-undef
        var arr = Object.keys(test_data)
        var res = document.createElement('div')

        var remark = document.createElement('div')

        remark.innerHTML = 'ç‚¹å‡»åï¼Œå†æ‰“å¼€'
        res.appendChild(remark)

        arr.forEach(function(item) {
          var temp = document.createElement('div')

          temp.className = 'btn btn-margin'
          // eslint-disable-next-line no-undef
          temp.innerHTML = test_data[item].remark
          temp.addEventListener('click', function() {
            window.location.replace(window.location.origin + window.location.pathname + '?type=' + item)
          })
          res.appendChild(temp)
        })
        return res
      }

      if (device_info.is_mobile) {
        if (device_info.is_weixin_browser) {
          // åœ¨ç§»åŠ¨ç«¯.å¾®ä¿¡æµè§ˆå™¨ä¸­æ‰“å¼€
          block__top.style.paddingRight = (device_info.is_iphone ? 31.5 : 28.5) - rem + 'px' // é€‚é…ä¸‰ä¸ªç‚¹ç‚¹çš„ä½ç½®
          block__top.style.display = 'flex'
          block__bottom.style.display = 'flex'

          test_center.appendChild(getHTML())
          test_center.style.display = 'flex'
        } else {
          // åœ¨ç§»åŠ¨ç«¯.éå¾®ä¿¡æµè§ˆå™¨ä¸­æ‰“å¼€
          window.location.href = device_info.is_android ? url_info.scheme_url : url_info.short_url || url_info.scheme_url

          div__test.textContent = 'ç§»åŠ¨ç«¯å‡†å¤‡è·³è½¬ï¼š' + (device_info.is_android ? url_info.scheme_url : url_info.short_url || url_info.scheme_url)
          // å®‰å“ï¼Œé»˜è®¤æ‰“å¼€ç›®æ ‡é¡µï¼ˆå¤‡æ³¨ï¼šå½“ç”¨æˆ·æ²¡æœ‰appï¼Œåˆ™ç›´æ¥æ˜¾ç¤ºh5é¡µé¢ï¼‰
          // iosï¼Œæ²¡æœ‰é…ç½®é€šç”¨é“¾æ¥çš„ï¼Œé¡µé»˜è®¤æ‰“å¼€ç›®æ ‡é¡µï¼Œé˜²æ­¢ç”¨æˆ·æ²¡æœ‰ä¸‹è½½app
          // eslint-disable-next-line no-extra-parens
          if (device_info.is_android || (device_info.is_iphone && !url_info.universal_link)) {
            setTimeout(function() {
              window.location.href = url_info.short_url
            }, 300)
          }
          // iosä¿®æ”¹urlä¸ºå¯¹åº”çš„çŸ­é“¾æ¥ï¼ˆå³é€šç”¨é“¾æ¥ï¼‰ï¼Œï¼ˆå¦‚æœæœ‰å¯¹åº”çš„APPï¼‰æµè§ˆå™¨çš„urlä¸ä¼šå˜åŒ–ï¼Œä¼šé»˜è®¤æ‰“å¼€appã€‚
          // æ‰€ä»¥ï¼Œiosçš„æµè§ˆå™¨ä¼šæ˜¾ç¤ºæ‰“å¼€appå‰çš„é¡µé¢ï¼Œå³æˆ‘ä»¬çš„ä¸­é—´é¡µï¼ˆæ˜¯å¦éœ€è¦ç¾åŒ–ï¼Ÿï¼‰ï¼Œæˆ–è€…ä¸€ä¸ªiframeåµŒå¥—äº†ä¸€ä¸ª(æ•ˆæœä¸å¥½ï¼Œæ— æ³•æ‰“å¼€é€šç”¨é“¾æ¥)
        }
      } else {
        // åœ¨pcç«¯æ‰“å¼€
        window.location.href = url_info.short_url
        div__test.textContent = 'pcå‡†å¤‡è·³è½¬ï¼š' + url_info.short_url
      }
    })
  </script>

  <!-- ä¸šåŠ¡ï¼šæ¥å£è¯·æ±‚ -->
  <script>
    // æµ‹è¯•æ¥å£çš„è¯·æ±‚
    // eslint-disable-next-line no-undef
    // request({
    //   url: 'https://xiaomark.com/api/slmp/links/aseh7loi/',
    //   method: 'GET',
    //   data: {},
    //   success: function(res) {
    //     console.log({
    //       res
    //     })
    //   },
    //   error: function(err) {
    //     console.log({
    //       err
    //     })
    //   }
    // })
  </script>

  <!-- é¡µé¢æ ·å¼ -->
  <link rel="stylesheet" href="common.css">
  <style></style>
</head>

<body>
  <div id="container">
    <div id="div__test"></div>
    <!-- å¾®ä¿¡å†…æ‰“å¼€ -->
    <div id="block__top">
      <img id="img--arrow"
        src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACIUlEQVRYR+2VMUwTURjHv68p0sLGRJTEVVlkgqFtil4lpl0lEBJWlh4JBB3A2S5KNKG3sJIYCK4Qg5zScB1kggVYScA4sUGLNv3IUQ8uvXv37n0dWNqt7Xf3+73/vfc/hHv+4D3zoS3ATiD1cjpN9fqK/QgxEpnc/b5U4jxOlkAyow8T0QYQdN1AES4RMWdtF3dUJZQFPHCHyJRQEhDCW5AILeALRyjcsAkWbqNXTCKUgAheNo13Njih5d9zJaQCMrizcq5EoEBYeCsSQgFVOFfCV4AL50h4BNLadKoG9W+3JdMomoKz4RzI6Ohs/Pf53xn7+8OeB5/X1z9V3CWU0vRCnWjefTqiEHlVMpd23XMegaSWPySCp64LPfCRkTfdl7XqBgGlG35Y6orGcltbHy+CJBDhyDKNfomA/ouIBv9XrBR+10H+Eu7TgYh7llkcChR4kZ17fHVVzSPivrVd/OIebl55c++Lkkhm9AkiGujsjBk/NhdPAgVELxN/OB435umJLAnRfaVFZF8ognfE4s/t//9VKz+5ElKBIPjO5oc/tsBw9m0vVyJQIAzciZYrIRRQgbci4SvAgXMlPAKtwDkSHoGEpq8C0djdscFje7c7G050nJp/99sTgLhWNovjgT2Q0PKnQPCoMcSDC5NAOCubRp/sXTAFBIsAeBCNxV+rrtwviVq18hWAngHCnGUay6wmDBu96py0iFRvqDrfFrgG79ChMILMl3sAAAAASUVORK5CYII="
        alt="å‘ä¸Šçš„ç®­å¤´" />
      <div>ç‚¹å‡»å³ä¸Šè§’</div>
      <div>é€‰æ‹©åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€</div>
      <div>ğŸ˜Šè‡ªåŠ¨æ‰“å¼€æŠ–éŸ³</div>
    </div>
    <div id="block__bottom">
      <div>åœ¨ Safari ä¸­æ‰“å¼€</div>
    </div>
    <div id="test_center">
    </div>
  </div>
</body>

</html>